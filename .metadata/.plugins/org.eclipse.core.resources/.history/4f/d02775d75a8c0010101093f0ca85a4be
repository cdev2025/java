package com.mycompany.test;

import java.util.ArrayList;

public class BoxingUnboxingEx {

	public static void main(String[] args) {
		// 1) ArrayList<Integer>에 값 추가 (오토박싱: int -> Integer)
		ArrayList<Integer> numbers = new ArrayList<Integer>();
		numbers.add(10); // 자동으로 Integer.valueOf(10);
		numbers.add(20);
		numbers.add(30);
		numbers.add(40);
		numbers.add(50);
		
		// 2) 합계/평균/최대값 계산 
		int sum = 0;
		int max = Integer.MIN_VALUE;
		for (Integer n : numbers) { // n은 Integer
			sum += n; // n.intValue() : 언박싱: Integer -> int
			if (n > max) max = n;
		}
		double avg = sum / (double) numbers.size();
		
		System.out.println("ArrayList에 값 추가: " + numbers);
		System.out.println("합계: " + sum);
		System.out.println("평균: " + avg);
		System.out.println("최대값: " + max);
		
		// null 안전 처리 예시
		Integer mayNull =null;
		if(mayNull != null) {
			int safe = mayNull; // 언박싱 OK
			System.out.println("null아님, 값: " +safe);
		} else {
			System.out.println("mayNull은 null이라 언박싱하면 Null Point Error 발생 -> 먼저 null 체크!!!");
		}
		
		// [ 기본형 연산 vs 오토박싱 / 언박싱 연산 ] 성능 테스트
		final int LOOPS = 5_000_000;
		
		// 1. 기본형(int) 연산
		long t1 = System.nanoTime();
		int primitiveSum = 0;
		for (int i=0; i<LOOPS; i++) {
			primitiveSum += i;
		}
		long t2 = System.nanoTime();
		
		// 2. 오토박싱/언박싱 섞인 합산
		long t3 = System.nanoTime();
		int boxedSum = 0;
		for (int i=0; i<LOOPS; i++) {
			boxedSum += i;
		}
		long t4 = System.nanoTime();
		
		System.out.println();
		System.out.println("====성능테스트====");
		System.out.println("기본형 연산 합계: " + primitiveSum + , ", 소요: "+ ms(t1, t2) + " ms");
		System.out.println("오토박싱/언박싱 연산 합계: " + boxedSum + , ", 소요: "+ ms(t3, t4) + " ms");
		System.out.println("(환경마다 수치는 달라질 수 있지만, 보통 기본형이 더 빠릅니다.");
		
	} //end of main
	
	private static long ms(long startNs, long endNs) {
		return (endNs - startNs) / 1_000_000;
	}

}
